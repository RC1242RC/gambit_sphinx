<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Program Listing for File ATLASEfficiencies.hpp &mdash; GAMBIT  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/collapsible-lists/css/tree_view.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  <div class="col-lg-9 col-xl-8 text-center">
    <p class="meta"><a href="/">⇦ Back to GAMBIT homepage</a></p>
  </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div> 

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="library_root.html">Library API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GAMBIT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Program Listing for File ATLASEfficiencies.hpp</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="program-listing-for-file-atlasefficiencies-hpp">
<span id="program-listing-file-colliderbit-include-gambit-colliderbit-atlasefficiencies-hpp"></span><h1>Program Listing for File ATLASEfficiencies.hpp<a class="headerlink" href="#program-listing-for-file-atlasefficiencies-hpp" title="Permalink to this headline"></a></h1>
<p>↰ <a class="reference internal" href="file_ColliderBit_include_gambit_ColliderBit_ATLASEfficiencies.hpp.html#file-colliderbit-include-gambit-colliderbit-atlasefficiencies-hpp"><span class="std std-ref">Return to documentation for file</span></a> (<code class="docutils literal notranslate"><span class="pre">ColliderBit/include/gambit/ColliderBit/ATLASEfficiencies.hpp</span></code>)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//   GAMBIT: Global and Modular BSM Inference Tool</span>
<span class="c1">//  *********************************************</span>


<span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cfloat&gt;</span><span class="cp"></span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;gambit/ColliderBit/Utils.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;gambit/Utils/threadsafe_rng.hpp&quot;</span><span class="cp"></span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;HEPUtils/MathUtils.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;HEPUtils/BinnedFn.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;HEPUtils/Event.h&quot;</span><span class="cp"></span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">Gambit</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">  </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ColliderBit</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>


<span class="w">    </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ATLAS</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>


<span class="w">        </span><span class="c1">// /// Randomly filter the supplied particle list by parameterised electron tracking efficiency</span>
<span class="w">        </span><span class="c1">// /// @todo Remove? This is not the electron efficiency</span>
<span class="w">        </span><span class="c1">// inline void applyElectronTrackingEff(std::vector&lt;const HEPUtils::Particle*&gt;&amp; electrons) {</span>
<span class="w">        </span><span class="c1">//   static HEPUtils::BinnedFn2D&lt;double&gt; _elTrackEff2d({{0, 1.5, 2.5, DBL_MAX}}, //&lt; |eta|</span>
<span class="w">        </span><span class="c1">//                                                     {{0, 0.1, 1.0, 100, DBL_MAX}}, //&lt; pT</span>
<span class="w">        </span><span class="c1">//                                                     {{0., 0.73, 0.95, 0.99,</span>
<span class="w">        </span><span class="c1">//                                                       0., 0.5,  0.83, 0.90,</span>
<span class="w">        </span><span class="c1">//                                                       0., 0.,   0.,   0.}});</span>
<span class="w">        </span><span class="c1">//   filtereff_etapt(electrons, _elTrackEff2d);</span>
<span class="w">        </span><span class="c1">// }</span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyElectronEff</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_elEff2d</span><span class="p">({{</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="n">DBL_MAX</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; |eta|</span>
<span class="w">                                                       </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="mf">10.</span><span class="p">,</span><span class="n">DBL_MAX</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; pT</span>
<span class="w">                                                       </span><span class="p">{{</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                         </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                         </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">}});</span><span class="w"></span>
<span class="w">          </span><span class="n">filtereff_etapt</span><span class="p">(</span><span class="n">electrons</span><span class="p">,</span><span class="w"> </span><span class="n">_elEff2d</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="c1">// /// Randomly filter the supplied particle list by parameterised muon tracking efficiency</span>
<span class="w">        </span><span class="c1">// /// @todo Remove? This is not the muon efficiency</span>
<span class="w">        </span><span class="c1">// inline void applyMuonTrackEff(std::vector&lt;const HEPUtils::Particle*&gt;&amp; muons) {</span>
<span class="w">        </span><span class="c1">//   static HEPUtils::BinnedFn2D&lt;double&gt; _muTrackEff2d({{0,1.5,2.5,DBL_MAX}}, //&lt; |eta|</span>
<span class="w">        </span><span class="c1">//                                                     {{0,0.1,1.0,DBL_MAX}}, //&lt; pT</span>
<span class="w">        </span><span class="c1">//                                                     {{0., 0.75, 0.99,</span>
<span class="w">        </span><span class="c1">//                                                       0., 0.70, 0.98,</span>
<span class="w">        </span><span class="c1">//                                                       0., 0.,   0.}});</span>
<span class="w">        </span><span class="c1">//   filtereff_etapt(muons, _muTrackEff2d);</span>
<span class="w">        </span><span class="c1">// }</span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyMuonEff</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">muons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_muEff2d</span><span class="p">({{</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.7</span><span class="p">,</span><span class="n">DBL_MAX</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; |eta|</span>
<span class="w">                                                       </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="n">DBL_MAX</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; pT</span>
<span class="w">                                                       </span><span class="p">{{</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                         </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                         </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">}});</span><span class="w"></span>
<span class="w">          </span><span class="n">filtereff_etapt</span><span class="p">(</span><span class="n">muons</span><span class="p">,</span><span class="w"> </span><span class="n">_muEff2d</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyMuonEffR2</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">muons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_muEff2d</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.7</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="p">},</span><span class="w"> </span><span class="c1">//&lt; |eta|</span>
<span class="w">                                                       </span><span class="p">{</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">3.5</span><span class="p">,</span><span class="w"> </span><span class="mf">4.</span><span class="p">,</span><span class="w"> </span><span class="mf">5.</span><span class="p">,</span><span class="w"> </span><span class="mf">6.</span><span class="p">,</span><span class="w"> </span><span class="mf">7.</span><span class="p">,</span><span class="w"> </span><span class="mf">8.</span><span class="p">,</span><span class="w"> </span><span class="mf">10.</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="p">},</span><span class="w"> </span><span class="c1">//&lt; pT</span>
<span class="w">                                                       </span><span class="p">{</span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.76</span><span class="p">,</span><span class="w"> </span><span class="mf">0.94</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.99</span><span class="p">,</span><span class="c1">//</span>
<span class="w">                                                        </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="n">filtereff_etapt</span><span class="p">(</span><span class="n">muons</span><span class="p">,</span><span class="w"> </span><span class="n">_muEff2d</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyTauEfficiencyR1</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">taus</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="n">filtereff</span><span class="p">(</span><span class="n">taus</span><span class="p">,</span><span class="w"> </span><span class="mf">0.40</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyTauEfficiencyR2</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">taus</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Delphes 3.3.2 config:</span>
<span class="w">          </span><span class="c1">//   set DeltaR 0.2</span>
<span class="w">          </span><span class="c1">//   set DeltaRTrack 0.2</span>
<span class="w">          </span><span class="c1">//   set TrackPTMin 1.0</span>
<span class="w">          </span><span class="c1">//   set TauPTMin 1.0</span>
<span class="w">          </span><span class="c1">//   set TauEtaMax 2.5</span>
<span class="w">          </span><span class="c1">//   # instructions: {n-prongs} {eff}</span>
<span class="w">          </span><span class="c1">//   # 1 - one prong efficiency</span>
<span class="w">          </span><span class="c1">//   # 2 - two or more efficiency</span>
<span class="w">          </span><span class="c1">//   # -1 - one prong mistag rate</span>
<span class="w">          </span><span class="c1">//   # -2 - two or more mistag rate</span>
<span class="w">          </span><span class="c1">//   set BitNumber 0</span>
<span class="w">          </span><span class="c1">//   # taken from ATL-PHYS-PUB-2015-045 (medium working point)</span>
<span class="w">          </span><span class="c1">//   add EfficiencyFormula {1} {0.70}</span>
<span class="w">          </span><span class="c1">//   add EfficiencyFormula {2} {0.60}</span>
<span class="w">          </span><span class="c1">//   add EfficiencyFormula {-1} {0.02}</span>
<span class="w">          </span><span class="c1">//   add EfficiencyFormula {-2} {0.01}</span>
<span class="w">          </span><span class="c1">// filtereff(taus, 0.65);</span>

<span class="w">          </span><span class="c1">// Distributions from ATL-PHYS-PUB-2015-045, Fig 10</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_pt</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w">  </span><span class="mf">20.</span><span class="p">,</span><span class="w">  </span><span class="mf">40.</span><span class="p">,</span><span class="w">   </span><span class="mf">60.</span><span class="p">,</span><span class="w">   </span><span class="mf">120.</span><span class="p">,</span><span class="w">  </span><span class="mf">160.</span><span class="p">,</span><span class="w">   </span><span class="mf">220.</span><span class="p">,</span><span class="w">   </span><span class="mf">280.</span><span class="p">,</span><span class="w">   </span><span class="mf">380.</span><span class="p">,</span><span class="w">    </span><span class="mf">500.</span><span class="p">,</span><span class="w">  </span><span class="n">DBL_MAX</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_1p</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w">  </span><span class="mf">.54</span><span class="p">,</span><span class="w">  </span><span class="mf">.55</span><span class="p">,</span><span class="w">   </span><span class="mf">.56</span><span class="p">,</span><span class="w">    </span><span class="mf">.58</span><span class="p">,</span><span class="w">   </span><span class="mf">.57</span><span class="p">,</span><span class="w">    </span><span class="mf">.56</span><span class="p">,</span><span class="w">    </span><span class="mf">.54</span><span class="p">,</span><span class="w">     </span><span class="mf">.51</span><span class="p">,</span><span class="w">     </span><span class="mf">0.</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_3p</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w">  </span><span class="mf">.40</span><span class="p">,</span><span class="w">  </span><span class="mf">.41</span><span class="p">,</span><span class="w">   </span><span class="mf">.42</span><span class="p">,</span><span class="w">    </span><span class="mf">.46</span><span class="p">,</span><span class="w">   </span><span class="mf">.46</span><span class="p">,</span><span class="w">    </span><span class="mf">.43</span><span class="p">,</span><span class="w">    </span><span class="mf">.39</span><span class="p">,</span><span class="w">     </span><span class="mf">.33</span><span class="p">,</span><span class="w">     </span><span class="mf">0.</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_pt_1p</span><span class="p">(</span><span class="n">binedges_pt</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_pt_1p</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_pt_3p</span><span class="p">(</span><span class="n">binedges_pt</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_pt_3p</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="c1">// 85% 1-prong, 15% &gt;=3-prong</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w">  </span><span class="mf">.52</span><span class="p">,</span><span class="w">  </span><span class="mf">.53</span><span class="p">,</span><span class="w">   </span><span class="mf">.54</span><span class="p">,</span><span class="w">    </span><span class="mf">.56</span><span class="p">,</span><span class="w">   </span><span class="mf">.55</span><span class="p">,</span><span class="w">    </span><span class="mf">.54</span><span class="p">,</span><span class="w">    </span><span class="mf">.52</span><span class="p">,</span><span class="w">     </span><span class="mf">.48</span><span class="p">,</span><span class="w">     </span><span class="mf">0.</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_pt_avg</span><span class="p">(</span><span class="n">binedges_pt</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_pt_avg</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="n">filtereff_pt</span><span class="p">(</span><span class="n">taus</span><span class="p">,</span><span class="w"> </span><span class="n">_eff_pt_avg</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="p">}</span><span class="w"></span>



<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyPhotonEfficiencyR2</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">photons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_eta</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">1.37</span><span class="p">,</span><span class="w"> </span><span class="mf">1.52</span><span class="p">,</span><span class="w"> </span><span class="mf">1.81</span><span class="p">,</span><span class="w"> </span><span class="mf">2.37</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_pt</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">10.</span><span class="p">,</span><span class="w"> </span><span class="mf">15.</span><span class="p">,</span><span class="w"> </span><span class="mf">20.</span><span class="p">,</span><span class="w"> </span><span class="mf">25.</span><span class="p">,</span><span class="w"> </span><span class="mf">30.</span><span class="p">,</span><span class="w"> </span><span class="mf">35.</span><span class="p">,</span><span class="w"> </span><span class="mf">40.</span><span class="p">,</span><span class="w"> </span><span class="mf">45.</span><span class="p">,</span><span class="w"> </span><span class="mf">50.</span><span class="p">,</span><span class="w"> </span><span class="mf">60.</span><span class="p">,</span><span class="w"> </span><span class="mf">80.</span><span class="p">,</span><span class="w"> </span><span class="mf">100.</span><span class="p">,</span><span class="w"> </span><span class="mf">125.</span><span class="p">,</span><span class="w"> </span><span class="mf">150.</span><span class="p">,</span><span class="w"> </span><span class="mf">175.</span><span class="p">,</span><span class="w"> </span><span class="mf">250.</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_etapt</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.55</span><span class="p">,</span><span class="w"> </span><span class="mf">0.70</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85</span><span class="p">,</span><span class="w"> </span><span class="mf">0.89</span><span class="p">,</span><span class="w"> </span><span class="mf">0.93</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="c1">//</span>
<span class="w">                                                              </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.47</span><span class="p">,</span><span class="w"> </span><span class="mf">0.66</span><span class="p">,</span><span class="w"> </span><span class="mf">0.79</span><span class="p">,</span><span class="w"> </span><span class="mf">0.86</span><span class="p">,</span><span class="w"> </span><span class="mf">0.89</span><span class="p">,</span><span class="w"> </span><span class="mf">0.94</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="c1">//</span>
<span class="w">                                                              </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="c1">//</span>
<span class="w">                                                              </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.54</span><span class="p">,</span><span class="w"> </span><span class="mf">0.71</span><span class="p">,</span><span class="w"> </span><span class="mf">0.84</span><span class="p">,</span><span class="w"> </span><span class="mf">0.88</span><span class="p">,</span><span class="w"> </span><span class="mf">0.92</span><span class="p">,</span><span class="w"> </span><span class="mf">0.93</span><span class="p">,</span><span class="w"> </span><span class="mf">0.94</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="c1">//</span>
<span class="w">                                                              </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.61</span><span class="p">,</span><span class="w"> </span><span class="mf">0.74</span><span class="p">,</span><span class="w"> </span><span class="mf">0.83</span><span class="p">,</span><span class="w"> </span><span class="mf">0.88</span><span class="p">,</span><span class="w"> </span><span class="mf">0.91</span><span class="p">,</span><span class="w"> </span><span class="mf">0.94</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mf">0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="c1">//</span>
<span class="w">                                                              </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_etapt</span><span class="p">(</span><span class="n">binedges_eta</span><span class="p">,</span><span class="w"> </span><span class="n">binedges_pt</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_etapt</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="n">filtereff_etapt</span><span class="p">(</span><span class="n">photons</span><span class="p">,</span><span class="w"> </span><span class="n">_eff_etapt</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">smearElectronEnergy</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Function that mimics the DELPHES electron energy resolution</span>
<span class="w">          </span><span class="c1">// We need to smear E, then recalculate pT, then reset 4 vector</span>

<span class="w">          </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">coeffE2</span><span class="p">({{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">3.</span><span class="p">,</span><span class="w"> </span><span class="mf">5.</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; |eta|</span>
<span class="w">                                                      </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">25.</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; pT</span>
<span class="w">                                                      </span><span class="p">{{</span><span class="mf">0.</span><span class="p">,</span><span class="w">          </span><span class="mf">0.015</span><span class="o">*</span><span class="mf">0.015</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005</span><span class="o">*</span><span class="mf">0.005</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                        </span><span class="mf">0.005</span><span class="o">*</span><span class="mf">0.005</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005</span><span class="o">*</span><span class="mf">0.005</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005</span><span class="o">*</span><span class="mf">0.005</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                        </span><span class="mf">0.107</span><span class="o">*</span><span class="mf">0.107</span><span class="p">,</span><span class="w"> </span><span class="mf">0.107</span><span class="o">*</span><span class="mf">0.107</span><span class="p">,</span><span class="w"> </span><span class="mf">0.107</span><span class="o">*</span><span class="mf">0.107</span><span class="p">}});</span><span class="w"></span>

<span class="w">          </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">coeffE</span><span class="p">({{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">3.</span><span class="p">,</span><span class="w"> </span><span class="mf">5.</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; |eta|</span>
<span class="w">                                                     </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">25.</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; pT</span>
<span class="w">                                                     </span><span class="p">{{</span><span class="mf">0.</span><span class="p">,</span><span class="w">        </span><span class="mf">0.</span><span class="p">,</span><span class="w">        </span><span class="mf">0.05</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                       </span><span class="mf">0.05</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.05</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.05</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                       </span><span class="mf">2.08</span><span class="o">*</span><span class="mf">2.08</span><span class="p">,</span><span class="w"> </span><span class="mf">2.08</span><span class="o">*</span><span class="mf">2.08</span><span class="p">,</span><span class="w"> </span><span class="mf">2.08</span><span class="o">*</span><span class="mf">2.08</span><span class="p">}});</span><span class="w"></span>

<span class="w">          </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">coeffC</span><span class="p">({{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">3.</span><span class="p">,</span><span class="w"> </span><span class="mf">5.</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; |eta|</span>
<span class="w">                                                     </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">25.</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="p">}},</span><span class="w"> </span><span class="c1">//&lt; pT</span>
<span class="w">                                                     </span><span class="p">{{</span><span class="mf">0.</span><span class="p">,</span><span class="w">       </span><span class="mf">0.</span><span class="p">,</span><span class="w">       </span><span class="mf">0.25</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                       </span><span class="mf">0.25</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                       </span><span class="mf">0.</span><span class="p">,</span><span class="w">       </span><span class="mf">0.</span><span class="p">,</span><span class="w">       </span><span class="mf">0.</span><span class="p">}});</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Now loop over the electrons and smear the 4-vectors</span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span><span class="w"></span>

<span class="w">            </span><span class="c1">// Look up / calculate resolution</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffE2</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffE</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">c3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeffC</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">sqr</span><span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">E</span><span class="p">())</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c2</span><span class="o">*</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">E</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c3</span><span class="p">);</span><span class="w"></span>

<span class="w">            </span><span class="c1">// Smear by a Gaussian centered on the current energy, with width given by the resolution</span>
<span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">normal_distribution</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">E</span><span class="p">(),</span><span class="w"> </span><span class="n">resolution</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">smeared_E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">Random</span><span class="o">::</span><span class="n">rng</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">smeared_E</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">e</span><span class="o">-&gt;</span><span class="n">mass</span><span class="p">())</span><span class="w"> </span><span class="n">smeared_E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.01</span><span class="o">*</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">mass</span><span class="p">();</span><span class="w"></span>
<span class="w">            </span><span class="c1">// double smeared_pt = smeared_E/cosh(e-&gt;eta()); ///&lt; @todo Should be cosh(|eta|)?</span>
<span class="w">            </span><span class="n">e</span><span class="o">-&gt;</span><span class="n">set_mom</span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">P4</span><span class="o">::</span><span class="n">mkEtaPhiME</span><span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">eta</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="o">-&gt;</span><span class="n">phi</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="o">-&gt;</span><span class="n">mass</span><span class="p">(),</span><span class="w"> </span><span class="n">smeared_E</span><span class="p">));</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">smearMuonMomentum</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">muons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Function that mimics the DELPHES muon momentum resolution</span>
<span class="w">          </span><span class="c1">// We need to smear pT, then recalculate E, then reset 4 vector</span>

<span class="w">          </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_muEff</span><span class="p">({{</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">}},</span><span class="w"></span>
<span class="w">                                                     </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">10.</span><span class="p">,</span><span class="mf">200.</span><span class="p">,</span><span class="n">DBL_MAX</span><span class="p">}},</span><span class="w"></span>
<span class="w">                                                     </span><span class="p">{{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                       </span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.04</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.04</span><span class="p">,</span><span class="mf">0.05</span><span class="p">}});</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Now loop over the muons and smear the 4-vectors</span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">muons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">2.5</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span><span class="w"></span>

<span class="w">            </span><span class="c1">// Look up resolution</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_muEff</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">(),</span><span class="w"> </span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">());</span><span class="w"></span>

<span class="w">            </span><span class="c1">// Smear by a Gaussian centered on the current energy, with width given by the resolution</span>
<span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">normal_distribution</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">(),</span><span class="w"> </span><span class="n">resolution</span><span class="o">*</span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">smeared_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">Random</span><span class="o">::</span><span class="n">rng</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">smeared_pt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">smeared_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="c1">// const double smeared_E = smeared_pt*cosh(mu-&gt;eta()); ///&lt; @todo Should be cosh(|eta|)?</span>
<span class="w">            </span><span class="c1">// std::cout &lt;&lt; &quot;Muon pt &quot; &lt;&lt; mu_pt &lt;&lt; &quot; smeared &quot; &lt;&lt; smeared_pt &lt;&lt; endl;</span>
<span class="w">            </span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">set_mom</span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">P4</span><span class="o">::</span><span class="n">mkEtaPhiMPt</span><span class="p">(</span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">eta</span><span class="p">(),</span><span class="w"> </span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">phi</span><span class="p">(),</span><span class="w"> </span><span class="n">mu</span><span class="o">-&gt;</span><span class="n">mass</span><span class="p">(),</span><span class="w"> </span><span class="n">smeared_pt</span><span class="p">));</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">smearJets</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Jet</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">jets</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Function that mimics the DELPHES jet momentum resolution.</span>
<span class="w">          </span><span class="c1">// We need to smear pT, then recalculate E, then reset the 4-vector.</span>
<span class="w">          </span><span class="c1">// Const resolution for now</span>
<span class="w">          </span><span class="c1">//const double resolution = 0.03;</span>

<span class="w">          </span><span class="c1">// Matthias jet smearing implemented roughly from</span>
<span class="w">          </span><span class="c1">// https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/CONFNOTES/ATLAS-CONF-2015-017/</span>
<span class="w">          </span><span class="c1">// Parameterisation can be still improved, but eta dependence is minimal</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binedges_eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mf">10.</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binedges_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mf">50.</span><span class="p">,</span><span class="mf">70.</span><span class="p">,</span><span class="mf">100.</span><span class="p">,</span><span class="mf">150.</span><span class="p">,</span><span class="mf">200.</span><span class="p">,</span><span class="mf">1000.</span><span class="p">,</span><span class="mf">10000.</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">JetsJER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.145</span><span class="p">,</span><span class="mf">0.115</span><span class="p">,</span><span class="mf">0.095</span><span class="p">,</span><span class="mf">0.075</span><span class="p">,</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.04</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn2D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_resJets2D</span><span class="p">(</span><span class="n">binedges_eta</span><span class="p">,</span><span class="n">binedges_pt</span><span class="p">,</span><span class="n">JetsJER</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Now loop over the jets and smear the 4-vectors</span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Jet</span><span class="o">*</span><span class="w"> </span><span class="n">jet</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">jets</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_resJets2D</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">jet</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">(),</span><span class="w"> </span><span class="n">jet</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">normal_distribution</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="n">resolution</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Smear by a Gaussian centered on 1 with width given by the (fractional) resolution</span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">smear_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">Random</span><span class="o">::</span><span class="n">rng</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="n">jet</span><span class="o">-&gt;</span><span class="n">set_mom</span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">P4</span><span class="o">::</span><span class="n">mkXYZM</span><span class="p">(</span><span class="n">jet</span><span class="o">-&gt;</span><span class="n">mom</span><span class="p">().</span><span class="n">px</span><span class="p">()</span><span class="o">*</span><span class="n">smear_factor</span><span class="p">,</span><span class="w"> </span><span class="n">jet</span><span class="o">-&gt;</span><span class="n">mom</span><span class="p">().</span><span class="n">py</span><span class="p">()</span><span class="o">*</span><span class="n">smear_factor</span><span class="p">,</span><span class="w"> </span><span class="n">jet</span><span class="o">-&gt;</span><span class="n">mom</span><span class="p">().</span><span class="n">pz</span><span class="p">()</span><span class="o">*</span><span class="n">smear_factor</span><span class="p">,</span><span class="w"> </span><span class="n">jet</span><span class="o">-&gt;</span><span class="n">mass</span><span class="p">()));</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">smearMET</span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">P4</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pmiss</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">set</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Smearing function from ATLAS Run 1 performance paper, converted from Rivet</span>
<span class="w">          </span><span class="c1">// cf. https://arxiv.org/pdf/1108.5602v2.pdf, Figs 14 and 15</span>

<span class="w">          </span><span class="c1">// Linearity offset (Fig 14)</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pmiss</span><span class="p">.</span><span class="n">pT</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="w"> </span><span class="n">pmiss</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mf">1.05</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pmiss</span><span class="p">.</span><span class="n">pT</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="n">pmiss</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.05</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mf">0.04</span><span class="o">/</span><span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pmiss</span><span class="p">.</span><span class="n">pT</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">25</span><span class="p">));</span><span class="w"> </span><span class="c1">//&lt; linear decrease</span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="n">pmiss</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mf">1.01</span><span class="p">;</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Smear by a Gaussian with width given by the resolution(sumEt) ~ 0.45 sqrt(sumEt) GeV</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.45</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">set</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">normal_distribution</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">pmiss</span><span class="p">.</span><span class="n">pT</span><span class="p">(),</span><span class="w"> </span><span class="n">resolution</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">smearedmet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">Random</span><span class="o">::</span><span class="n">rng</span><span class="p">()),</span><span class="w"> </span><span class="mf">0.</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="n">pmiss</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">smearedmet</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pmiss</span><span class="p">.</span><span class="n">pT</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">smearTaus</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">taus</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// We need to smear pT, then recalculate E, then reset the 4-vector.</span>
<span class="w">          </span><span class="c1">// Same as for jets, but on a vector of particles. (?)</span>
<span class="w">          </span><span class="c1">// Const resolution for now</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.03</span><span class="p">;</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Now loop over the jets and smear the 4-vectors</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">normal_distribution</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="n">resolution</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">taus</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Smear by a Gaussian centered on 1 with width given by the (fractional) resolution</span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">smear_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">Random</span><span class="o">::</span><span class="n">rng</span><span class="p">());</span><span class="w"></span>
<span class="w">            </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">set_mom</span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">P4</span><span class="o">::</span><span class="n">mkXYZM</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">mom</span><span class="p">().</span><span class="n">px</span><span class="p">()</span><span class="o">*</span><span class="n">smear_factor</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">mom</span><span class="p">().</span><span class="n">py</span><span class="p">()</span><span class="o">*</span><span class="n">smear_factor</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">mom</span><span class="p">().</span><span class="n">pz</span><span class="p">()</span><span class="o">*</span><span class="n">smear_factor</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">mass</span><span class="p">()));</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyLooseIDElectronSelectionR2</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">electrons</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Manually symmetrised eta eff histogram</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">   </span><span class="mf">0.1</span><span class="p">,</span><span class="w">   </span><span class="mf">0.8</span><span class="p">,</span><span class="w">   </span><span class="mf">1.37</span><span class="p">,</span><span class="w">  </span><span class="mf">1.52</span><span class="p">,</span><span class="w">  </span><span class="mf">2.01</span><span class="p">,</span><span class="w">  </span><span class="mf">2.37</span><span class="p">,</span><span class="w">  </span><span class="mf">2.47</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_eta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.950</span><span class="p">,</span><span class="w"> </span><span class="mf">0.965</span><span class="p">,</span><span class="w"> </span><span class="mf">0.955</span><span class="p">,</span><span class="w"> </span><span class="mf">0.885</span><span class="p">,</span><span class="w"> </span><span class="mf">0.950</span><span class="p">,</span><span class="w"> </span><span class="mf">0.935</span><span class="p">,</span><span class="w"> </span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_eta</span><span class="p">(</span><span class="n">binedges_eta</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Et eff histogram (10-20 GeV bin added by hand)</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_et</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">   </span><span class="mi">20</span><span class="p">,</span><span class="w">   </span><span class="mi">25</span><span class="p">,</span><span class="w">   </span><span class="mi">30</span><span class="p">,</span><span class="w">   </span><span class="mi">35</span><span class="p">,</span><span class="w">   </span><span class="mi">40</span><span class="p">,</span><span class="w">    </span><span class="mi">45</span><span class="p">,</span><span class="w">    </span><span class="mi">50</span><span class="p">,</span><span class="w">   </span><span class="mi">60</span><span class="p">,</span><span class="w">  </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_et</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="mf">0.91</span><span class="p">,</span><span class="w"> </span><span class="mf">0.92</span><span class="p">,</span><span class="w"> </span><span class="mf">0.94</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mf">0.955</span><span class="p">,</span><span class="w"> </span><span class="mf">0.965</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_et</span><span class="p">(</span><span class="n">binedges_et</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_et</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">auto</span><span class="w"> </span><span class="n">keptElectronsEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">remove_if</span><span class="p">(</span><span class="n">electrons</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">electrons</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"></span>
<span class="w">                                                 </span><span class="p">[](</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*</span><span class="w"> </span><span class="n">electron</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">electron</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">();</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e_aeta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">electron</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">();</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e_aeta</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">2.47</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">e_pt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">eff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_eff_eta</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">e_aeta</span><span class="p">),</span><span class="w"> </span><span class="n">eff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_eff_et</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">e_pt</span><span class="p">);</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">eff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">eff1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eff2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt; norm factor as approximate double differential</span>
<span class="w">                                                   </span><span class="k">return</span><span class="w"> </span><span class="n">random_bool</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eff</span><span class="p">);</span><span class="w"></span>
<span class="w">                                                 </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="n">electrons</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">keptElectronsEnd</span><span class="p">,</span><span class="w"> </span><span class="n">electrons</span><span class="p">.</span><span class="n">end</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyLooseIDElectronSelectionR2</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="n">applyLooseIDElectronSelectionR2</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;&gt;</span><span class="p">(</span><span class="n">electrons</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyMediumIDElectronSelectionR2</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">electrons</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Manually symmetrised eta eff histogram</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">   </span><span class="mf">0.1</span><span class="p">,</span><span class="w">   </span><span class="mf">0.8</span><span class="p">,</span><span class="w">   </span><span class="mf">1.37</span><span class="p">,</span><span class="w">  </span><span class="mf">1.52</span><span class="p">,</span><span class="w">  </span><span class="mf">2.01</span><span class="p">,</span><span class="w">  </span><span class="mf">2.37</span><span class="p">,</span><span class="w">  </span><span class="mf">2.47</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_eta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.900</span><span class="p">,</span><span class="w"> </span><span class="mf">0.930</span><span class="p">,</span><span class="w"> </span><span class="mf">0.905</span><span class="p">,</span><span class="w"> </span><span class="mf">0.830</span><span class="p">,</span><span class="w"> </span><span class="mf">0.900</span><span class="p">,</span><span class="w"> </span><span class="mf">0.880</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_eta</span><span class="p">(</span><span class="n">binedges_eta</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Et eff histogram (10-20 GeV bin added by hand)</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_et</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">   </span><span class="mi">20</span><span class="p">,</span><span class="w">   </span><span class="mi">25</span><span class="p">,</span><span class="w">   </span><span class="mi">30</span><span class="p">,</span><span class="w">   </span><span class="mi">35</span><span class="p">,</span><span class="w">   </span><span class="mi">40</span><span class="p">,</span><span class="w">    </span><span class="mi">45</span><span class="p">,</span><span class="w">    </span><span class="mi">50</span><span class="p">,</span><span class="w">   </span><span class="mi">60</span><span class="p">,</span><span class="w">  </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_et</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.83</span><span class="p">,</span><span class="w"> </span><span class="mf">0.845</span><span class="p">,</span><span class="w"> </span><span class="mf">0.87</span><span class="p">,</span><span class="w"> </span><span class="mf">0.89</span><span class="p">,</span><span class="w"> </span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="mf">0.91</span><span class="p">,</span><span class="w"> </span><span class="mf">0.92</span><span class="p">,</span><span class="w"> </span><span class="mf">0.93</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_et</span><span class="p">(</span><span class="n">binedges_et</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_et</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">auto</span><span class="w"> </span><span class="n">keptElectronsEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">remove_if</span><span class="p">(</span><span class="n">electrons</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">electrons</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"></span>
<span class="w">                                                 </span><span class="p">[](</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*</span><span class="w"> </span><span class="n">electron</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">electron</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">();</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e_aeta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">electron</span><span class="o">-&gt;</span><span class="n">abseta</span><span class="p">();</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e_aeta</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">2.47</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">e_pt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">eff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_eff_eta</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">e_aeta</span><span class="p">),</span><span class="w"> </span><span class="n">eff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_eff_et</span><span class="p">.</span><span class="n">get_at</span><span class="p">(</span><span class="n">e_pt</span><span class="p">);</span><span class="w"></span>
<span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">eff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">eff1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eff2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt; norm factor as approximate double differential</span>
<span class="w">                                                   </span><span class="k">return</span><span class="w"> </span><span class="n">random_bool</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eff</span><span class="p">);</span><span class="w"></span>
<span class="w">                                                 </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="n">electrons</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">keptElectronsEnd</span><span class="p">,</span><span class="w"> </span><span class="n">electrons</span><span class="p">.</span><span class="n">end</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyMediumIDElectronSelectionR2</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="n">applyMediumIDElectronSelectionR2</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;&gt;</span><span class="p">(</span><span class="n">electrons</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyMediumIDElectronSelection</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">electrons</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E10_15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0494681</span><span class="p">,</span><span class="w"> </span><span class="mf">0.453578</span><span class="p">,</span><span class="w"> </span><span class="mf">1.10675</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46298</span><span class="p">,</span><span class="w"> </span><span class="mf">1.78963</span><span class="p">,</span><span class="w"> </span><span class="mf">2.2766</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E10_15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.730435</span><span class="p">,</span><span class="w"> </span><span class="mf">0.730435</span><span class="p">,</span><span class="w"> </span><span class="mf">0.782609</span><span class="p">,</span><span class="w"> </span><span class="mf">0.776812</span><span class="p">,</span><span class="w"> </span><span class="mf">0.765217</span><span class="p">,</span><span class="w"> </span><span class="mf">0.773913</span><span class="p">,</span><span class="w"> </span><span class="mf">0.77971</span><span class="p">,</span><span class="w"> </span><span class="mf">0.776812</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E10_15</span><span class="p">(</span><span class="n">binedges_E10_15</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E10_15</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E15_20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0533175</span><span class="p">,</span><span class="w"> </span><span class="mf">0.456161</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1019</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46327</span><span class="p">,</span><span class="w"> </span><span class="mf">1.78318</span><span class="p">,</span><span class="w"> </span><span class="mf">2.26303</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E15_20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.77971</span><span class="p">,</span><span class="w"> </span><span class="mf">0.77971</span><span class="p">,</span><span class="w"> </span><span class="mf">0.82029</span><span class="p">,</span><span class="w"> </span><span class="mf">0.817391</span><span class="p">,</span><span class="w"> </span><span class="mf">0.701449</span><span class="p">,</span><span class="w"> </span><span class="mf">0.797101</span><span class="p">,</span><span class="w"> </span><span class="mf">0.828986</span><span class="p">,</span><span class="w"> </span><span class="mf">0.828986</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E15_20</span><span class="p">(</span><span class="n">binedges_E15_20</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E15_20</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E20_25</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.45249</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.21496</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.94181</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.6924</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.46675</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.26485</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.991686</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.682898</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.350356</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0415677</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0653207</span><span class="p">,</span><span class="w"> </span><span class="mf">0.362233</span><span class="p">,</span><span class="w"> </span><span class="mf">0.718527</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97981</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2886</span><span class="p">,</span><span class="w"> </span><span class="mf">1.45487</span><span class="p">,</span><span class="w"> </span><span class="mf">1.68052</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94181</span><span class="p">,</span><span class="w"> </span><span class="mf">2.23872</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45249</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E20_25</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.827811</span><span class="p">,</span><span class="w"> </span><span class="mf">0.82572</span><span class="p">,</span><span class="w"> </span><span class="mf">0.790414</span><span class="p">,</span><span class="w"> </span><span class="mf">0.798585</span><span class="p">,</span><span class="w"> </span><span class="mf">0.779843</span><span class="p">,</span><span class="w"> </span><span class="mf">0.727974</span><span class="p">,</span><span class="w"> </span><span class="mf">0.802447</span><span class="p">,</span><span class="w"> </span><span class="mf">0.798192</span><span class="p">,</span><span class="w"> </span><span class="mf">0.812561</span><span class="p">,</span><span class="w"> </span><span class="mf">0.812423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.808153</span><span class="p">,</span><span class="w"> </span><span class="mf">0.779115</span><span class="p">,</span><span class="w"> </span><span class="mf">0.822483</span><span class="p">,</span><span class="w"> </span><span class="mf">0.816123</span><span class="p">,</span><span class="w"> </span><span class="mf">0.795304</span><span class="p">,</span><span class="w"> </span><span class="mf">0.793105</span><span class="p">,</span><span class="w"> </span><span class="mf">0.772326</span><span class="p">,</span><span class="w"> </span><span class="mf">0.778446</span><span class="p">,</span><span class="w"> </span><span class="mf">0.794906</span><span class="p">,</span><span class="w"> </span><span class="mf">0.78857</span><span class="p">,</span><span class="w"> </span><span class="mf">0.821617</span><span class="p">,</span><span class="w"> </span><span class="mf">0.821593</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E20_25</span><span class="p">(</span><span class="n">binedges_E20_25</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E20_25</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E25_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.45249</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22684</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.92993</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.6924</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.46675</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.26485</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.97981</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.694774</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.33848</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0534442</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0771971</span><span class="p">,</span><span class="w"> </span><span class="mf">0.33848</span><span class="p">,</span><span class="w"> </span><span class="mf">0.74228</span><span class="p">,</span><span class="w"> </span><span class="mf">1.00356</span><span class="p">,</span><span class="w"> </span><span class="mf">1.26485</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46675</span><span class="p">,</span><span class="w"> </span><span class="mf">1.6924</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94181</span><span class="p">,</span><span class="w"> </span><span class="mf">2.22684</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45249</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E25_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.84095</span><span class="p">,</span><span class="w"> </span><span class="mf">0.838892</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8286</span><span class="p">,</span><span class="w"> </span><span class="mf">0.830801</span><span class="p">,</span><span class="w"> </span><span class="mf">0.818436</span><span class="p">,</span><span class="w"> </span><span class="mf">0.76037</span><span class="p">,</span><span class="w"> </span><span class="mf">0.841463</span><span class="p">,</span><span class="w"> </span><span class="mf">0.83535</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850008</span><span class="p">,</span><span class="w"> </span><span class="mf">0.852233</span><span class="p">,</span><span class="w"> </span><span class="mf">0.837812</span><span class="p">,</span><span class="w"> </span><span class="mf">0.82748</span><span class="p">,</span><span class="w"> </span><span class="mf">0.854592</span><span class="p">,</span><span class="w"> </span><span class="mf">0.854759</span><span class="p">,</span><span class="w"> </span><span class="mf">0.838251</span><span class="p">,</span><span class="w"> </span><span class="mf">0.844591</span><span class="p">,</span><span class="w"> </span><span class="mf">0.76782</span><span class="p">,</span><span class="w"> </span><span class="mf">0.815688</span><span class="p">,</span><span class="w"> </span><span class="mf">0.836563</span><span class="p">,</span><span class="w"> </span><span class="mf">0.824219</span><span class="p">,</span><span class="w"> </span><span class="mf">0.838853</span><span class="p">,</span><span class="w"> </span><span class="mf">0.838877</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E25_30</span><span class="p">(</span><span class="n">binedges_E25_30</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E25_30</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E30_35</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.44062</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.21496</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.92993</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.68052</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.46675</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.27672</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.991686</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.706651</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.350356</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0534442</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0771971</span><span class="p">,</span><span class="w"> </span><span class="mf">0.350356</span><span class="p">,</span><span class="w"> </span><span class="mf">0.706651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.97981</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2886</span><span class="p">,</span><span class="w"> </span><span class="mf">1.47862</span><span class="p">,</span><span class="w"> </span><span class="mf">1.68052</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94181</span><span class="p">,</span><span class="w"> </span><span class="mf">2.23872</span><span class="p">,</span><span class="w"> </span><span class="mf">2.44062</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E30_35</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.849263</span><span class="p">,</span><span class="w"> </span><span class="mf">0.849233</span><span class="p">,</span><span class="w"> </span><span class="mf">0.840831</span><span class="p">,</span><span class="w"> </span><span class="mf">0.853176</span><span class="p">,</span><span class="w"> </span><span class="mf">0.844763</span><span class="p">,</span><span class="w"> </span><span class="mf">0.771974</span><span class="p">,</span><span class="w"> </span><span class="mf">0.873676</span><span class="p">,</span><span class="w"> </span><span class="mf">0.865249</span><span class="p">,</span><span class="w"> </span><span class="mf">0.877593</span><span class="p">,</span><span class="w"> </span><span class="mf">0.883677</span><span class="p">,</span><span class="w"> </span><span class="mf">0.869013</span><span class="p">,</span><span class="w"> </span><span class="mf">0.856496</span><span class="p">,</span><span class="w"> </span><span class="mf">0.879231</span><span class="p">,</span><span class="w"> </span><span class="mf">0.883238</span><span class="p">,</span><span class="w"> </span><span class="mf">0.870661</span><span class="p">,</span><span class="w"> </span><span class="mf">0.870533</span><span class="p">,</span><span class="w"> </span><span class="mf">0.779059</span><span class="p">,</span><span class="w"> </span><span class="mf">0.839213</span><span class="p">,</span><span class="w"> </span><span class="mf">0.84949</span><span class="p">,</span><span class="w"> </span><span class="mf">0.834827</span><span class="p">,</span><span class="w"> </span><span class="mf">0.834743</span><span class="p">,</span><span class="w"> </span><span class="mf">0.834718</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E30_35</span><span class="p">(</span><span class="n">binedges_E30_35</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E30_35</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E35_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.44841</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.23431</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.94914</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.69969</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.46336</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.28359</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.998664</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.713488</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.357087</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0723338</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0580256</span><span class="p">,</span><span class="w"> </span><span class="mf">0.343519</span><span class="p">,</span><span class="w"> </span><span class="mf">0.699955</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0085</span><span class="p">,</span><span class="w"> </span><span class="mf">1.26989</span><span class="p">,</span><span class="w"> </span><span class="mf">1.45836</span><span class="p">,</span><span class="w"> </span><span class="mf">1.685</span><span class="p">,</span><span class="w"> </span><span class="mf">1.93451</span><span class="p">,</span><span class="w"> </span><span class="mf">2.23118</span><span class="p">,</span><span class="w"> </span><span class="mf">2.46818</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E35_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.836795</span><span class="p">,</span><span class="w"> </span><span class="mf">0.84095</span><span class="p">,</span><span class="w"> </span><span class="mf">0.859644</span><span class="p">,</span><span class="w"> </span><span class="mf">0.867953</span><span class="p">,</span><span class="w"> </span><span class="mf">0.87003</span><span class="p">,</span><span class="w"> </span><span class="mf">0.799407</span><span class="p">,</span><span class="w"> </span><span class="mf">0.894955</span><span class="p">,</span><span class="w"> </span><span class="mf">0.888724</span><span class="p">,</span><span class="w"> </span><span class="mf">0.897033</span><span class="p">,</span><span class="w"> </span><span class="mf">0.903264</span><span class="p">,</span><span class="w"> </span><span class="mf">0.886647</span><span class="p">,</span><span class="w"> </span><span class="mf">0.87003</span><span class="p">,</span><span class="w"> </span><span class="mf">0.897033</span><span class="p">,</span><span class="w"> </span><span class="mf">0.905341</span><span class="p">,</span><span class="w"> </span><span class="mf">0.890801</span><span class="p">,</span><span class="w"> </span><span class="mf">0.897033</span><span class="p">,</span><span class="w"> </span><span class="mf">0.805638</span><span class="p">,</span><span class="w"> </span><span class="mf">0.863798</span><span class="p">,</span><span class="w"> </span><span class="mf">0.87003</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85549</span><span class="p">,</span><span class="w"> </span><span class="mf">0.824332</span><span class="p">,</span><span class="w"> </span><span class="mf">0.826409</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E35_40</span><span class="p">(</span><span class="n">binedges_E35_40</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E35_40</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E40_45</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.45261</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22749</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.93128</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.68246</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.46919</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.27962</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.995261</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.7109</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.343602</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0592417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0473934</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35545</span><span class="p">,</span><span class="w"> </span><span class="mf">0.699052</span><span class="p">,</span><span class="w"> </span><span class="mf">0.983412</span><span class="p">,</span><span class="w"> </span><span class="mf">1.27962</span><span class="p">,</span><span class="w"> </span><span class="mf">1.4455</span><span class="p">,</span><span class="w"> </span><span class="mf">1.69431</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94313</span><span class="p">,</span><span class="w"> </span><span class="mf">2.22749</span><span class="p">,</span><span class="w"> </span><span class="mf">2.44076</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E40_45</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.836795</span><span class="p">,</span><span class="w"> </span><span class="mf">0.836795</span><span class="p">,</span><span class="w"> </span><span class="mf">0.87003</span><span class="p">,</span><span class="w"> </span><span class="mf">0.882493</span><span class="p">,</span><span class="w"> </span><span class="mf">0.897033</span><span class="p">,</span><span class="w"> </span><span class="mf">0.84095</span><span class="p">,</span><span class="w"> </span><span class="mf">0.911573</span><span class="p">,</span><span class="w"> </span><span class="mf">0.89911</span><span class="p">,</span><span class="w"> </span><span class="mf">0.907418</span><span class="p">,</span><span class="w"> </span><span class="mf">0.909496</span><span class="p">,</span><span class="w"> </span><span class="mf">0.89911</span><span class="p">,</span><span class="w"> </span><span class="mf">0.888724</span><span class="p">,</span><span class="w"> </span><span class="mf">0.907418</span><span class="p">,</span><span class="w"> </span><span class="mf">0.91365</span><span class="p">,</span><span class="w"> </span><span class="mf">0.89911</span><span class="p">,</span><span class="w"> </span><span class="mf">0.907418</span><span class="p">,</span><span class="w"> </span><span class="mf">0.843027</span><span class="p">,</span><span class="w"> </span><span class="mf">0.890801</span><span class="p">,</span><span class="w"> </span><span class="mf">0.882493</span><span class="p">,</span><span class="w"> </span><span class="mf">0.87003</span><span class="p">,</span><span class="w"> </span><span class="mf">0.816024</span><span class="p">,</span><span class="w"> </span><span class="mf">0.816024</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E40_45</span><span class="p">(</span><span class="n">binedges_E40_45</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E40_45</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E45_50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.46086</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22192</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.93675</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.68709</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.46211</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.27124</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.986416</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.689328</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.356822</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0482438</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0584337</span><span class="p">,</span><span class="w"> </span><span class="mf">0.355838</span><span class="p">,</span><span class="w"> </span><span class="mf">0.712203</span><span class="p">,</span><span class="w"> </span><span class="mf">0.996992</span><span class="p">,</span><span class="w"> </span><span class="mf">1.28217</span><span class="p">,</span><span class="w"> </span><span class="mf">1.45947</span><span class="p">,</span><span class="w"> </span><span class="mf">1.68576</span><span class="p">,</span><span class="w"> </span><span class="mf">1.93499</span><span class="p">,</span><span class="w"> </span><span class="mf">2.21988</span><span class="p">,</span><span class="w"> </span><span class="mf">2.44378</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binvalues_E45_50</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.807101</span><span class="p">,</span><span class="w"> </span><span class="mf">0.807101</span><span class="p">,</span><span class="w"> </span><span class="mf">0.889941</span><span class="p">,</span><span class="w"> </span><span class="mf">0.898225</span><span class="p">,</span><span class="w"> </span><span class="mf">0.912722</span><span class="p">,</span><span class="w"> </span><span class="mf">0.873373</span><span class="p">,</span><span class="w"> </span><span class="mf">0.923077</span><span class="p">,</span><span class="w"> </span><span class="mf">0.910651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.921006</span><span class="p">,</span><span class="w"> </span><span class="mf">0.918935</span><span class="p">,</span><span class="w"> </span><span class="mf">0.906509</span><span class="p">,</span><span class="w"> </span><span class="mf">0.894083</span><span class="p">,</span><span class="w"> </span><span class="mf">0.923077</span><span class="p">,</span><span class="w"> </span><span class="mf">0.927219</span><span class="p">,</span><span class="w"> </span><span class="mf">0.912722</span><span class="p">,</span><span class="w"> </span><span class="mf">0.921006</span><span class="p">,</span><span class="w"> </span><span class="mf">0.871302</span><span class="p">,</span><span class="w"> </span><span class="mf">0.90858</span><span class="p">,</span><span class="w"> </span><span class="mf">0.898225</span><span class="p">,</span><span class="w"> </span><span class="mf">0.889941</span><span class="p">,</span><span class="w"> </span><span class="mf">0.786391</span><span class="p">,</span><span class="w"> </span><span class="mf">0.786391</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E45_50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">binedges_E45_50</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E45_50</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E50_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.44076</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.21564</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.93128</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.69431</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.46919</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.26777</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.983412</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.7109</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.35545</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0592417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0592417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35545</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7109</span><span class="p">,</span><span class="w"> </span><span class="mf">0.983412</span><span class="p">,</span><span class="w"> </span><span class="mf">1.27962</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46919</span><span class="p">,</span><span class="w"> </span><span class="mf">1.68246</span><span class="p">,</span><span class="w"> </span><span class="mf">1.91943</span><span class="p">,</span><span class="w"> </span><span class="mf">2.22749</span><span class="p">,</span><span class="w"> </span><span class="mf">2.44076</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binvalues_E50_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.785417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.785417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.891667</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9</span><span class="p">,</span><span class="w"> </span><span class="mf">0.916667</span><span class="p">,</span><span class="w"> </span><span class="mf">0.877083</span><span class="p">,</span><span class="w"> </span><span class="mf">0.927083</span><span class="p">,</span><span class="w"> </span><span class="mf">0.91875</span><span class="p">,</span><span class="w"> </span><span class="mf">0.91875</span><span class="p">,</span><span class="w"> </span><span class="mf">0.922917</span><span class="p">,</span><span class="w"> </span><span class="mf">0.90625</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9</span><span class="p">,</span><span class="w"> </span><span class="mf">0.922917</span><span class="p">,</span><span class="w"> </span><span class="mf">0.929167</span><span class="p">,</span><span class="w"> </span><span class="mf">0.920833</span><span class="p">,</span><span class="w"> </span><span class="mf">0.925</span><span class="p">,</span><span class="w"> </span><span class="mf">0.885417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9125</span><span class="p">,</span><span class="w"> </span><span class="mf">0.904167</span><span class="p">,</span><span class="w"> </span><span class="mf">0.885417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7625</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7625</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E50_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">binedges_E50_60</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E50_60</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E60_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.44933</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22119</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.9353</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.68491</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.47115</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.2682</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.982628</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.696912</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.351494</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0423579</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0526683</span><span class="p">,</span><span class="w"> </span><span class="mf">0.350856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.719871</span><span class="p">,</span><span class="w"> </span><span class="mf">1.00552</span><span class="p">,</span><span class="w"> </span><span class="mf">1.29137</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46938</span><span class="p">,</span><span class="w"> </span><span class="mf">1.69596</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94572</span><span class="p">,</span><span class="w"> </span><span class="mf">2.24305</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45479</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binvalues_E60_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.779163</span><span class="p">,</span><span class="w"> </span><span class="mf">0.779188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.893866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.904402</span><span class="p">,</span><span class="w"> </span><span class="mf">0.927423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.896262</span><span class="p">,</span><span class="w"> </span><span class="mf">0.92968</span><span class="p">,</span><span class="w"> </span><span class="mf">0.921466</span><span class="p">,</span><span class="w"> </span><span class="mf">0.921585</span><span class="p">,</span><span class="w"> </span><span class="mf">0.932145</span><span class="p">,</span><span class="w"> </span><span class="mf">0.909357</span><span class="p">,</span><span class="w"> </span><span class="mf">0.896897</span><span class="p">,</span><span class="w"> </span><span class="mf">0.930355</span><span class="p">,</span><span class="w"> </span><span class="mf">0.928425</span><span class="p">,</span><span class="w"> </span><span class="mf">0.924377</span><span class="p">,</span><span class="w"> </span><span class="mf">0.93283</span><span class="p">,</span><span class="w"> </span><span class="mf">0.899571</span><span class="p">,</span><span class="w"> </span><span class="mf">0.922582</span><span class="p">,</span><span class="w"> </span><span class="mf">0.908102</span><span class="p">,</span><span class="w"> </span><span class="mf">0.89156</span><span class="p">,</span><span class="w"> </span><span class="mf">0.741648</span><span class="p">,</span><span class="w"> </span><span class="mf">0.741678</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E60_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">binedges_E60_80</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E60_80</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.45835</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22058</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.94663</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.68451</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.44712</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.27961</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.970161</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.708258</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.351259</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0537477</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0532884</span><span class="p">,</span><span class="w"> </span><span class="mf">0.351188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.72041</span><span class="p">,</span><span class="w"> </span><span class="mf">0.994111</span><span class="p">,</span><span class="w"> </span><span class="mf">1.29176</span><span class="p">,</span><span class="w"> </span><span class="mf">1.4815</span><span class="p">,</span><span class="w"> </span><span class="mf">1.70839</span><span class="p">,</span><span class="w"> </span><span class="mf">1.93419</span><span class="p">,</span><span class="w"> </span><span class="mf">2.21998</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45825</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binvalues_E80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.951041</span><span class="p">,</span><span class="w"> </span><span class="mf">0.948944</span><span class="p">,</span><span class="w"> </span><span class="mf">0.930151</span><span class="p">,</span><span class="w"> </span><span class="mf">0.938346</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9507</span><span class="p">,</span><span class="w"> </span><span class="mf">0.909058</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95884</span><span class="p">,</span><span class="w"> </span><span class="mf">0.954557</span><span class="p">,</span><span class="w"> </span><span class="mf">0.954449</span><span class="p">,</span><span class="w"> </span><span class="mf">0.945992</span><span class="p">,</span><span class="w"> </span><span class="mf">0.939637</span><span class="p">,</span><span class="w"> </span><span class="mf">0.933361</span><span class="p">,</span><span class="w"> </span><span class="mf">0.949854</span><span class="p">,</span><span class="w"> </span><span class="mf">0.960086</span><span class="p">,</span><span class="w"> </span><span class="mf">0.953741</span><span class="p">,</span><span class="w"> </span><span class="mf">0.955695</span><span class="p">,</span><span class="w"> </span><span class="mf">0.911996</span><span class="p">,</span><span class="w"> </span><span class="mf">0.953445</span><span class="p">,</span><span class="w"> </span><span class="mf">0.930502</span><span class="p">,</span><span class="w"> </span><span class="mf">0.934538</span><span class="p">,</span><span class="w"> </span><span class="mf">0.944824</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9448</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">binedges_E80</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E80</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Now loop over the electrons and only keep those that pass the random efficiency cut</span>
<span class="w">          </span><span class="k">auto</span><span class="w"> </span><span class="n">keptElectronsEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">remove_if</span><span class="p">(</span><span class="n">electrons</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">electrons</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"></span>
<span class="w">                                             </span><span class="p">[](</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*</span><span class="w"> </span><span class="n">electron</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                               </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">electron</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">();</span><span class="w"></span>
<span class="w">                                               </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e_eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">electron</span><span class="o">-&gt;</span><span class="n">eta</span><span class="p">();</span><span class="w"></span>
<span class="w">                                               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">e_eta</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">e_pt</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E10_15</span><span class="p">,</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">e_eta</span><span class="p">));</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E15_20</span><span class="p">,</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">e_eta</span><span class="p">));</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E20_25</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E25_30</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">35</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E30_35</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E35_40</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E40_45</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E45_50</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E50_60</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E60_80</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E80</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                             </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="n">electrons</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">keptElectronsEnd</span><span class="p">,</span><span class="w"> </span><span class="n">electrons</span><span class="p">.</span><span class="n">end</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyMediumIDElectronSelection</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="n">applyMediumIDElectronSelection</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;&gt;</span><span class="p">(</span><span class="n">electrons</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyTightIDElectronSelection</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E10_15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0485903</span><span class="p">,</span><span class="w"> </span><span class="mf">0.458914</span><span class="p">,</span><span class="w"> </span><span class="mf">1.10009</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46117</span><span class="p">,</span><span class="w"> </span><span class="mf">1.78881</span><span class="p">,</span><span class="w"> </span><span class="mf">2.27013</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E10_15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.57971</span><span class="p">,</span><span class="w"> </span><span class="mf">0.582609</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681159</span><span class="p">,</span><span class="w"> </span><span class="mf">0.655072</span><span class="p">,</span><span class="w"> </span><span class="mf">0.46087</span><span class="p">,</span><span class="w"> </span><span class="mf">0.634783</span><span class="p">,</span><span class="w"> </span><span class="mf">0.689855</span><span class="p">,</span><span class="w"> </span><span class="mf">0.689855</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E10_15</span><span class="p">(</span><span class="n">binedges_E10_15</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E10_15</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E15_20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0533175</span><span class="p">,</span><span class="w"> </span><span class="mf">0.450237</span><span class="p">,</span><span class="w"> </span><span class="mf">1.09597</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46327</span><span class="p">,</span><span class="w"> </span><span class="mf">1.78318</span><span class="p">,</span><span class="w"> </span><span class="mf">2.26896</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E15_20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.631884</span><span class="p">,</span><span class="w"> </span><span class="mf">0.628986</span><span class="p">,</span><span class="w"> </span><span class="mf">0.727536</span><span class="p">,</span><span class="w"> </span><span class="mf">0.701449</span><span class="p">,</span><span class="w"> </span><span class="mf">0.565217</span><span class="p">,</span><span class="w"> </span><span class="mf">0.666667</span><span class="p">,</span><span class="w"> </span><span class="mf">0.733333</span><span class="p">,</span><span class="w"> </span><span class="mf">0.733333</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E15_20</span><span class="p">(</span><span class="n">binedges_E15_20</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E15_20</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E20_25</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.44062</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22684</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.92993</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.66865</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.45487</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.26485</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.967933</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.706651</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.350356</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0415677</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0653207</span><span class="p">,</span><span class="w"> </span><span class="mf">0.362233</span><span class="p">,</span><span class="w"> </span><span class="mf">0.718527</span><span class="p">,</span><span class="w"> </span><span class="mf">0.991686</span><span class="p">,</span><span class="w"> </span><span class="mf">1.27672</span><span class="p">,</span><span class="w"> </span><span class="mf">1.47862</span><span class="p">,</span><span class="w"> </span><span class="mf">1.6924</span><span class="p">,</span><span class="w"> </span><span class="mf">1.92993</span><span class="p">,</span><span class="w"> </span><span class="mf">2.22684</span><span class="p">,</span><span class="w"> </span><span class="mf">2.46437</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E20_25</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.678698</span><span class="p">,</span><span class="w"> </span><span class="mf">0.678674</span><span class="p">,</span><span class="w"> </span><span class="mf">0.70965</span><span class="p">,</span><span class="w"> </span><span class="mf">0.65361</span><span class="p">,</span><span class="w"> </span><span class="mf">0.655573</span><span class="p">,</span><span class="w"> </span><span class="mf">0.599567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6844</span><span class="p">,</span><span class="w"> </span><span class="mf">0.694632</span><span class="p">,</span><span class="w"> </span><span class="mf">0.729731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.731654</span><span class="p">,</span><span class="w"> </span><span class="mf">0.665254</span><span class="p">,</span><span class="w"> </span><span class="mf">0.640358</span><span class="p">,</span><span class="w"> </span><span class="mf">0.743785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.733282</span><span class="p">,</span><span class="w"> </span><span class="mf">0.697962</span><span class="p">,</span><span class="w"> </span><span class="mf">0.672992</span><span class="p">,</span><span class="w"> </span><span class="mf">0.585926</span><span class="p">,</span><span class="w"> </span><span class="mf">0.660394</span><span class="p">,</span><span class="w"> </span><span class="mf">0.652011</span><span class="p">,</span><span class="w"> </span><span class="mf">0.703663</span><span class="p">,</span><span class="w"> </span><span class="mf">0.670429</span><span class="p">,</span><span class="w"> </span><span class="mf">0.668338</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E20_25</span><span class="p">(</span><span class="n">binedges_E20_25</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E20_25</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E25_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.44062</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22684</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.91805</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.68052</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.45487</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.27672</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.97981</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.706651</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.350356</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0415677</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0771971</span><span class="p">,</span><span class="w"> </span><span class="mf">0.362233</span><span class="p">,</span><span class="w"> </span><span class="mf">0.718527</span><span class="p">,</span><span class="w"> </span><span class="mf">0.991686</span><span class="p">,</span><span class="w"> </span><span class="mf">1.30048</span><span class="p">,</span><span class="w"> </span><span class="mf">1.47862</span><span class="p">,</span><span class="w"> </span><span class="mf">1.6924</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94181</span><span class="p">,</span><span class="w"> </span><span class="mf">2.22684</span><span class="p">,</span><span class="w"> </span><span class="mf">2.46437</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E25_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.678932</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681034</span><span class="p">,</span><span class="w"> </span><span class="mf">0.737205</span><span class="p">,</span><span class="w"> </span><span class="mf">0.683328</span><span class="p">,</span><span class="w"> </span><span class="mf">0.695889</span><span class="p">,</span><span class="w"> </span><span class="mf">0.633669</span><span class="p">,</span><span class="w"> </span><span class="mf">0.720983</span><span class="p">,</span><span class="w"> </span><span class="mf">0.733569</span><span class="p">,</span><span class="w"> </span><span class="mf">0.758609</span><span class="p">,</span><span class="w"> </span><span class="mf">0.769142</span><span class="p">,</span><span class="w"> </span><span class="mf">0.69657</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688311</span><span class="p">,</span><span class="w"> </span><span class="mf">0.771515</span><span class="p">,</span><span class="w"> </span><span class="mf">0.771663</span><span class="p">,</span><span class="w"> </span><span class="mf">0.734388</span><span class="p">,</span><span class="w"> </span><span class="mf">0.717899</span><span class="p">,</span><span class="w"> </span><span class="mf">0.636964</span><span class="p">,</span><span class="w"> </span><span class="mf">0.699368</span><span class="p">,</span><span class="w"> </span><span class="mf">0.689086</span><span class="p">,</span><span class="w"> </span><span class="mf">0.730747</span><span class="p">,</span><span class="w"> </span><span class="mf">0.67684</span><span class="p">,</span><span class="w"> </span><span class="mf">0.67686</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E25_30</span><span class="p">(</span><span class="n">binedges_E25_30</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E25_30</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E30_35</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.45249</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.21496</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.94181</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.68052</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.47862</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.27672</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.97981</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.706651</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.33848</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0415677</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0534442</span><span class="p">,</span><span class="w"> </span><span class="mf">0.362233</span><span class="p">,</span><span class="w"> </span><span class="mf">0.718527</span><span class="p">,</span><span class="w"> </span><span class="mf">1.00356</span><span class="p">,</span><span class="w"> </span><span class="mf">1.27672</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46675</span><span class="p">,</span><span class="w"> </span><span class="mf">1.68052</span><span class="p">,</span><span class="w"> </span><span class="mf">1.95368</span><span class="p">,</span><span class="w"> </span><span class="mf">2.23872</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45249</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E30_35</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.691395</span><span class="p">,</span><span class="w"> </span><span class="mf">0.691375</span><span class="p">,</span><span class="w"> </span><span class="mf">0.749436</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716089</span><span class="p">,</span><span class="w"> </span><span class="mf">0.726366</span><span class="p">,</span><span class="w"> </span><span class="mf">0.653582</span><span class="p">,</span><span class="w"> </span><span class="mf">0.749047</span><span class="p">,</span><span class="w"> </span><span class="mf">0.771772</span><span class="p">,</span><span class="w"> </span><span class="mf">0.800739</span><span class="p">,</span><span class="w"> </span><span class="mf">0.802663</span><span class="p">,</span><span class="w"> </span><span class="mf">0.731916</span><span class="p">,</span><span class="w"> </span><span class="mf">0.71526</span><span class="p">,</span><span class="w"> </span><span class="mf">0.802372</span><span class="p">,</span><span class="w"> </span><span class="mf">0.810532</span><span class="p">,</span><span class="w"> </span><span class="mf">0.773025</span><span class="p">,</span><span class="w"> </span><span class="mf">0.75214</span><span class="p">,</span><span class="w"> </span><span class="mf">0.656512</span><span class="p">,</span><span class="w"> </span><span class="mf">0.722892</span><span class="p">,</span><span class="w"> </span><span class="mf">0.712393</span><span class="p">,</span><span class="w"> </span><span class="mf">0.745509</span><span class="p">,</span><span class="w"> </span><span class="mf">0.670643</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6727</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E30_35</span><span class="p">(</span><span class="n">binedges_E30_35</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E30_35</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E35_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.46296</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22413</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.93966</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.7017</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.47721</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.28567</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.988409</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.714721</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.334744</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0510125</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0437527</span><span class="p">,</span><span class="w"> </span><span class="mf">0.342215</span><span class="p">,</span><span class="w"> </span><span class="mf">0.710598</span><span class="p">,</span><span class="w"> </span><span class="mf">0.971211</span><span class="p">,</span><span class="w"> </span><span class="mf">1.27968</span><span class="p">,</span><span class="w"> </span><span class="mf">1.45638</span><span class="p">,</span><span class="w"> </span><span class="mf">1.68306</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94399</span><span class="p">,</span><span class="w"> </span><span class="mf">2.21764</span><span class="p">,</span><span class="w"> </span><span class="mf">2.44185</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E35_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.683086</span><span class="p">,</span><span class="w"> </span><span class="mf">0.683086</span><span class="p">,</span><span class="w"> </span><span class="mf">0.759941</span><span class="p">,</span><span class="w"> </span><span class="mf">0.726706</span><span class="p">,</span><span class="w"> </span><span class="mf">0.751632</span><span class="p">,</span><span class="w"> </span><span class="mf">0.683086</span><span class="p">,</span><span class="w"> </span><span class="mf">0.772404</span><span class="p">,</span><span class="w"> </span><span class="mf">0.793175</span><span class="p">,</span><span class="w"> </span><span class="mf">0.824332</span><span class="p">,</span><span class="w"> </span><span class="mf">0.820178</span><span class="p">,</span><span class="w"> </span><span class="mf">0.743323</span><span class="p">,</span><span class="w"> </span><span class="mf">0.728783</span><span class="p">,</span><span class="w"> </span><span class="mf">0.820178</span><span class="p">,</span><span class="w"> </span><span class="mf">0.832641</span><span class="p">,</span><span class="w"> </span><span class="mf">0.793175</span><span class="p">,</span><span class="w"> </span><span class="mf">0.774481</span><span class="p">,</span><span class="w"> </span><span class="mf">0.689318</span><span class="p">,</span><span class="w"> </span><span class="mf">0.749555</span><span class="p">,</span><span class="w"> </span><span class="mf">0.728783</span><span class="p">,</span><span class="w"> </span><span class="mf">0.757864</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6727</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6727</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E35_40</span><span class="p">(</span><span class="n">binedges_E35_40</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E35_40</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E40_45</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.45261</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.21564</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.94313</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.69431</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.45735</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.27962</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.983412</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.7109</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.35545</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0592417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0473934</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35545</span><span class="p">,</span><span class="w"> </span><span class="mf">0.699052</span><span class="p">,</span><span class="w"> </span><span class="mf">0.983412</span><span class="p">,</span><span class="w"> </span><span class="mf">1.26777</span><span class="p">,</span><span class="w"> </span><span class="mf">1.45735</span><span class="p">,</span><span class="w"> </span><span class="mf">1.67062</span><span class="p">,</span><span class="w"> </span><span class="mf">1.93128</span><span class="p">,</span><span class="w"> </span><span class="mf">2.20379</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45261</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binvalues_E40_45</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.693472</span><span class="p">,</span><span class="w"> </span><span class="mf">0.693472</span><span class="p">,</span><span class="w"> </span><span class="mf">0.782789</span><span class="p">,</span><span class="w"> </span><span class="mf">0.757864</span><span class="p">,</span><span class="w"> </span><span class="mf">0.784866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.726706</span><span class="p">,</span><span class="w"> </span><span class="mf">0.797329</span><span class="p">,</span><span class="w"> </span><span class="mf">0.803561</span><span class="p">,</span><span class="w"> </span><span class="mf">0.836795</span><span class="p">,</span><span class="w"> </span><span class="mf">0.805638</span><span class="p">,</span><span class="w"> </span><span class="mf">0.747478</span><span class="p">,</span><span class="w"> </span><span class="mf">0.735015</span><span class="p">,</span><span class="w"> </span><span class="mf">0.805638</span><span class="p">,</span><span class="w"> </span><span class="mf">0.843027</span><span class="p">,</span><span class="w"> </span><span class="mf">0.807715</span><span class="p">,</span><span class="w"> </span><span class="mf">0.797329</span><span class="p">,</span><span class="w"> </span><span class="mf">0.732938</span><span class="p">,</span><span class="w"> </span><span class="mf">0.780712</span><span class="p">,</span><span class="w"> </span><span class="mf">0.762018</span><span class="p">,</span><span class="w"> </span><span class="mf">0.782789</span><span class="p">,</span><span class="w"> </span><span class="mf">0.674777</span><span class="p">,</span><span class="w"> </span><span class="mf">0.674777</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E40_45</span><span class="p">(</span><span class="n">binedges_E40_45</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E40_45</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E45_50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.46311</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22329</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.93875</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.70073</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.47585</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.273</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.976015</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.714205</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.358403</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0625448</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0560444</span><span class="p">,</span><span class="w"> </span><span class="mf">0.354151</span><span class="p">,</span><span class="w"> </span><span class="mf">0.711078</span><span class="p">,</span><span class="w"> </span><span class="mf">0.98364</span><span class="p">,</span><span class="w"> </span><span class="mf">1.28045</span><span class="p">,</span><span class="w"> </span><span class="mf">1.45768</span><span class="p">,</span><span class="w"> </span><span class="mf">1.68407</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94493</span><span class="p">,</span><span class="w"> </span><span class="mf">2.20653</span><span class="p">,</span><span class="w"> </span><span class="mf">2.4415</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binvalues_E45_50</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.674556</span><span class="p">,</span><span class="w"> </span><span class="mf">0.674556</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809172</span><span class="p">,</span><span class="w"> </span><span class="mf">0.780178</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809172</span><span class="p">,</span><span class="w"> </span><span class="mf">0.763609</span><span class="p">,</span><span class="w"> </span><span class="mf">0.819527</span><span class="p">,</span><span class="w"> </span><span class="mf">0.823669</span><span class="p">,</span><span class="w"> </span><span class="mf">0.854734</span><span class="p">,</span><span class="w"> </span><span class="mf">0.82574</span><span class="p">,</span><span class="w"> </span><span class="mf">0.763609</span><span class="p">,</span><span class="w"> </span><span class="mf">0.753254</span><span class="p">,</span><span class="w"> </span><span class="mf">0.823669</span><span class="p">,</span><span class="w"> </span><span class="mf">0.860947</span><span class="p">,</span><span class="w"> </span><span class="mf">0.82574</span><span class="p">,</span><span class="w"> </span><span class="mf">0.819527</span><span class="p">,</span><span class="w"> </span><span class="mf">0.76568</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809172</span><span class="p">,</span><span class="w"> </span><span class="mf">0.78432</span><span class="p">,</span><span class="w"> </span><span class="mf">0.802959</span><span class="p">,</span><span class="w"> </span><span class="mf">0.651775</span><span class="p">,</span><span class="w"> </span><span class="mf">0.651775</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E45_50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">binedges_E45_50</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E45_50</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E50_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.45261</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.21564</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.93128</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.68246</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.45735</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.27962</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.995261</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.699052</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.343602</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0592417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0592417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.35545</span><span class="p">,</span><span class="w"> </span><span class="mf">0.699052</span><span class="p">,</span><span class="w"> </span><span class="mf">0.983412</span><span class="p">,</span><span class="w"> </span><span class="mf">1.26777</span><span class="p">,</span><span class="w"> </span><span class="mf">1.4455</span><span class="p">,</span><span class="w"> </span><span class="mf">1.68246</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94313</span><span class="p">,</span><span class="w"> </span><span class="mf">2.21564</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45261</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binvalues_E50_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.6625</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6625</span><span class="p">,</span><span class="w"> </span><span class="mf">0.810417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.795833</span><span class="p">,</span><span class="w"> </span><span class="mf">0.81875</span><span class="p">,</span><span class="w"> </span><span class="mf">0.779167</span><span class="p">,</span><span class="w"> </span><span class="mf">0.839583</span><span class="p">,</span><span class="w"> </span><span class="mf">0.84375</span><span class="p">,</span><span class="w"> </span><span class="mf">0.860417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.841667</span><span class="p">,</span><span class="w"> </span><span class="mf">0.777083</span><span class="p">,</span><span class="w"> </span><span class="mf">0.764583</span><span class="p">,</span><span class="w"> </span><span class="mf">0.841667</span><span class="p">,</span><span class="w"> </span><span class="mf">0.877083</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85</span><span class="p">,</span><span class="w"> </span><span class="mf">0.839583</span><span class="p">,</span><span class="w"> </span><span class="mf">0.785417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.816667</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.804167</span><span class="p">,</span><span class="w"> </span><span class="mf">0.64375</span><span class="p">,</span><span class="w"> </span><span class="mf">0.64375</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E50_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">binedges_E50_60</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E50_60</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E60_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.46326</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22265</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.93711</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.69844</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.47299</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.28152</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.995631</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.709702</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.364674</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0564949</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0504716</span><span class="p">,</span><span class="w"> </span><span class="mf">0.349652</span><span class="p">,</span><span class="w"> </span><span class="mf">0.707116</span><span class="p">,</span><span class="w"> </span><span class="mf">0.980538</span><span class="p">,</span><span class="w"> </span><span class="mf">1.27812</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46757</span><span class="p">,</span><span class="w"> </span><span class="mf">1.69447</span><span class="p">,</span><span class="w"> </span><span class="mf">1.94394</span><span class="p">,</span><span class="w"> </span><span class="mf">2.24157</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45288</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binvalues_E60_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.660412</span><span class="p">,</span><span class="w"> </span><span class="mf">0.660432</span><span class="p">,</span><span class="w"> </span><span class="mf">0.808449</span><span class="p">,</span><span class="w"> </span><span class="mf">0.798151</span><span class="p">,</span><span class="w"> </span><span class="mf">0.831584</span><span class="p">,</span><span class="w"> </span><span class="mf">0.787928</span><span class="p">,</span><span class="w"> </span><span class="mf">0.846341</span><span class="p">,</span><span class="w"> </span><span class="mf">0.856877</span><span class="p">,</span><span class="w"> </span><span class="mf">0.869496</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85714</span><span class="p">,</span><span class="w"> </span><span class="mf">0.778101</span><span class="p">,</span><span class="w"> </span><span class="mf">0.767729</span><span class="p">,</span><span class="w"> </span><span class="mf">0.859521</span><span class="p">,</span><span class="w"> </span><span class="mf">0.87842</span><span class="p">,</span><span class="w"> </span><span class="mf">0.855617</span><span class="p">,</span><span class="w"> </span><span class="mf">0.853658</span><span class="p">,</span><span class="w"> </span><span class="mf">0.79332</span><span class="p">,</span><span class="w"> </span><span class="mf">0.835081</span><span class="p">,</span><span class="w"> </span><span class="mf">0.803935</span><span class="p">,</span><span class="w"> </span><span class="mf">0.804059</span><span class="p">,</span><span class="w"> </span><span class="mf">0.629147</span><span class="p">,</span><span class="w"> </span><span class="mf">0.629172</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E60_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">binedges_E60_80</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E60_80</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_E80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-2.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.45987</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.22149</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.94797</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.69748</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.47206</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.29251</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.994818</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.709105</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.352212</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0558319</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0513809</span><span class="p">,</span><span class="w"> </span><span class="mf">0.374044</span><span class="p">,</span><span class="w"> </span><span class="mf">0.719562</span><span class="p">,</span><span class="w"> </span><span class="mf">0.981359</span><span class="p">,</span><span class="w"> </span><span class="mf">1.27873</span><span class="p">,</span><span class="w"> </span><span class="mf">1.46843</span><span class="p">,</span><span class="w"> </span><span class="mf">1.70723</span><span class="p">,</span><span class="w"> </span><span class="mf">1.9449</span><span class="p">,</span><span class="w"> </span><span class="mf">2.20712</span><span class="p">,</span><span class="w"> </span><span class="mf">2.45676</span><span class="p">,</span><span class="w"> </span><span class="mf">2.5</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w">  </span><span class="n">binvalues_E80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeBinValues</span><span class="p">({</span><span class="mf">0.859652</span><span class="p">,</span><span class="w"> </span><span class="mf">0.859627</span><span class="p">,</span><span class="w"> </span><span class="mf">0.876145</span><span class="p">,</span><span class="w"> </span><span class="mf">0.859415</span><span class="p">,</span><span class="w"> </span><span class="mf">0.888391</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8426</span><span class="p">,</span><span class="w"> </span><span class="mf">0.900685</span><span class="p">,</span><span class="w"> </span><span class="mf">0.904716</span><span class="p">,</span><span class="w"> </span><span class="mf">0.904597</span><span class="p">,</span><span class="w"> </span><span class="mf">0.889909</span><span class="p">,</span><span class="w"> </span><span class="mf">0.817086</span><span class="p">,</span><span class="w"> </span><span class="mf">0.821195</span><span class="p">,</span><span class="w"> </span><span class="mf">0.893762</span><span class="p">,</span><span class="w"> </span><span class="mf">0.910235</span><span class="p">,</span><span class="w"> </span><span class="mf">0.903895</span><span class="p">,</span><span class="w"> </span><span class="mf">0.889231</span><span class="p">,</span><span class="w"> </span><span class="mf">0.843455</span><span class="p">,</span><span class="w"> </span><span class="mf">0.884899</span><span class="p">,</span><span class="w"> </span><span class="mf">0.859875</span><span class="p">,</span><span class="w"> </span><span class="mf">0.87846</span><span class="p">,</span><span class="w"> </span><span class="mf">0.857585</span><span class="p">,</span><span class="w"> </span><span class="mf">0.85756</span><span class="p">});</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_E80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">binedges_E80</span><span class="p">,</span><span class="w"> </span><span class="n">binvalues_E80</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="c1">// Now loop over the electrons and only keep those that pass the random efficiency cut</span>
<span class="w">          </span><span class="k">auto</span><span class="w"> </span><span class="n">keptElectronsEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">remove_if</span><span class="p">(</span><span class="n">electrons</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">electrons</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"></span>
<span class="w">                                             </span><span class="p">[](</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*</span><span class="w"> </span><span class="n">electron</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                               </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">electron</span><span class="o">-&gt;</span><span class="n">pT</span><span class="p">();</span><span class="w"></span>
<span class="w">                                               </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e_eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">electron</span><span class="o">-&gt;</span><span class="n">eta</span><span class="p">();</span><span class="w"></span>
<span class="w">                                               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">e_eta</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">e_pt</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E10_15</span><span class="p">,</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">e_eta</span><span class="p">));</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E15_20</span><span class="p">,</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">e_eta</span><span class="p">));</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E20_25</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E25_30</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">35</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E30_35</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E35_40</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E40_45</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E45_50</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E50_60</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">in_range</span><span class="p">(</span><span class="n">e_pt</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E60_80</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                               </span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">random_bool</span><span class="p">(</span><span class="n">_eff_E80</span><span class="p">,</span><span class="w"> </span><span class="n">e_eta</span><span class="p">);</span><span class="w"></span>
<span class="w">                                             </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="n">electrons</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">keptElectronsEnd</span><span class="p">,</span><span class="w"> </span><span class="n">electrons</span><span class="p">.</span><span class="n">end</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyTightIDElectronSelection</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="n">applyTightIDElectronSelection</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;&gt;</span><span class="p">(</span><span class="n">electrons</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>


<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyElectronIDEfficiency2019</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="n">operating_point</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>

<span class="w">          </span><span class="c1">// digitised from Fig 8</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_pt</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">6.668795911849248</span><span class="p">,</span><span class="w"> </span><span class="mf">9.673354432217419</span><span class="p">,</span><span class="w"> </span><span class="mf">14.643593391597225</span><span class="p">,</span><span class="w"> </span><span class="mf">19.57318312476409</span><span class="p">,</span><span class="w"> </span><span class="mf">24.71356813100665</span><span class="p">,</span><span class="w"> </span><span class="mf">29.655352632037403</span><span class="p">,</span><span class="w"> </span><span class="mf">34.594233616910074</span><span class="p">,</span><span class="w"> </span><span class="mf">39.73636073284749</span><span class="p">,</span><span class="w"> </span><span class="mf">44.68221015649952</span><span class="p">,</span><span class="w"> </span><span class="mf">49.6292209866148</span><span class="p">,</span><span class="w"> </span><span class="mf">59.52440405330856</span><span class="p">,</span><span class="w"> </span><span class="mf">79.51859702099242</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_loose</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.9054376657824932</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9267904509283819</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8757294429708221</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8450928381962863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8775862068965516</span><span class="p">,</span><span class="w"> </span><span class="mf">0.889655172413793</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9035809018567638</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9193633952254641</span><span class="p">,</span><span class="w"> </span><span class="mf">0.929575596816976</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9370026525198938</span><span class="p">,</span><span class="w"> </span><span class="mf">0.942572944297082</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9509283819628646</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9592838196286471</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_medium</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.7355437665782492</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7912466843501325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7986737400530503</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7717506631299733</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8135278514588858</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8348806366047744</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8525198938992041</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8692307692307691</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8822281167108752</span><span class="p">,</span><span class="w"> </span><span class="mf">0.889655172413793</span><span class="p">,</span><span class="w"> </span><span class="mf">0.902652519893899</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9230769230769229</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9407161803713526</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_tight</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.5572944297082227</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6213527851458884</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6547745358090185</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6714854111405835</span><span class="p">,</span><span class="w"> </span><span class="mf">0.699336870026525</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7299734748010609</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7559681697612731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7754641909814322</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7921750663129972</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8079575596816975</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8311671087533155</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8710875331564986</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8989389920424402</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="c1">// select operating point</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operating_point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Loose&quot;</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">operating_point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;VeryLoose&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">bineffs_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bineffs_pt_loose</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operating_point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Medium&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">bineffs_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bineffs_pt_medium</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operating_point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Tight&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">bineffs_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bineffs_pt_tight</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span><span class="w"></span>
<span class="w">            </span><span class="n">utils_error</span><span class="p">().</span><span class="n">raise</span><span class="p">(</span><span class="n">LOCAL_INFO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Unknown operating point&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_pt</span><span class="p">(</span><span class="n">binedges_pt</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_pt</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="c1">// filter electrons</span>
<span class="w">          </span><span class="n">filtereff_pt</span><span class="p">(</span><span class="n">electrons</span><span class="p">,</span><span class="w"> </span><span class="n">_eff_pt</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyElectronIsolationEfficiency2019</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">Particle</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">electrons</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="n">operating_point</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>

<span class="w">          </span><span class="c1">// digitised from Fig 12</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">binedges_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">6.548307897301772</span><span class="p">,</span><span class="w"> </span><span class="mf">9.706735099256047</span><span class="p">,</span><span class="w"> </span><span class="mf">19.611982283197417</span><span class="p">,</span><span class="w"> </span><span class="mf">24.561829913760132</span><span class="p">,</span><span class="w"> </span><span class="mf">29.71154676569653</span><span class="p">,</span><span class="w"> </span><span class="mf">34.461525174885566</span><span class="p">,</span><span class="w"> </span><span class="mf">39.61370954807349</span><span class="p">,</span><span class="w"> </span><span class="mf">44.56047277707178</span><span class="p">,</span><span class="w"> </span><span class="mf">49.5109372879474</span><span class="p">,</span><span class="w"> </span><span class="mf">59.60803424919497</span><span class="p">,</span><span class="w"> </span><span class="mf">79.4086585320716</span><span class="p">,</span><span class="w"> </span><span class="n">DBL_MAX</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_loose_trackonly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.9694027334287603</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9841898810834618</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9915715839022242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9890807366218896</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9875756991852016</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9875509249064084</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9875261506276152</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9879947974014535</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9884634441752919</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9884386698964986</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9888959617925568</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9907953231667035</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9930404921823388</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_loose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.9595332801145123</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9812303870292888</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9891055109006828</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9875994412023784</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9856020149746753</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9826167143800926</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9820985190486677</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9820737447698745</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9820489704910813</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9825186495265361</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9829749091609778</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9903008698524555</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9930394599207224</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_gradient_loose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.8973632597445498</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9471843343977098</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9693676365338032</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9466465260955738</span><span class="p">,</span><span class="w"> </span><span class="mf">0.947115172869412</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9485706617485136</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9539735190486678</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9593784408720547</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9642868448579609</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9706755120017618</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9780417308962784</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9843808494824929</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9851457553402335</span><span class="p">};</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt_gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.8425935229024444</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9082030389781987</span><span class="p">,</span><span class="w"> </span><span class="mf">0.944204195111209</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9007573359392205</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9081359419731337</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9145235768553183</span><span class="p">,</span><span class="w"> </span><span class="mf">0.924368255890773</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9351987447698745</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9460292336489761</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9573531435807092</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9716251926888351</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9838874284298613</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9851457553402335</span><span class="p">};</span><span class="w"></span>

<span class="w">          </span><span class="c1">// select operating point</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bineffs_pt</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operating_point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;LooseTrackOnly&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">bineffs_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bineffs_pt_loose_trackonly</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operating_point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Loose&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">bineffs_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bineffs_pt_loose</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operating_point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;GradientLoose&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">bineffs_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bineffs_pt_gradient_loose</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operating_point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Gradient&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">bineffs_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bineffs_pt_gradient</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span><span class="w"></span>
<span class="w">           </span><span class="n">utils_error</span><span class="p">().</span><span class="n">raise</span><span class="p">(</span><span class="n">LOCAL_INFO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Unknown operating point&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HEPUtils</span><span class="o">::</span><span class="n">BinnedFn1D</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_eff_pt</span><span class="p">(</span><span class="n">binedges_pt</span><span class="p">,</span><span class="w"> </span><span class="n">bineffs_pt</span><span class="p">);</span><span class="w"></span>

<span class="w">          </span><span class="c1">// filter electrons</span>
<span class="w">          </span><span class="n">filtereff_pt</span><span class="p">(</span><span class="n">electrons</span><span class="p">,</span><span class="w"> </span><span class="n">_eff_pt</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>



<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  
<style>
  /* Sidebar header (and topbar for mobile) */
  .wy-side-nav-search, .wy-nav-top, .wy-nav-side {
    background: #efefef;
  }

  /* Sidebar text */
  .wy-menu-vertical a {
    color: #000000;
  }
</style>


</body>
</html>